---
title: "Informe TFM"
output: pdf_document
---

\fontsize{10}{15}
\fontseries{m}
\selectfont

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy = FALSE, out.width = "100%")
```


El siguiente informe recoge,

  por un lado, una **descripción de resultados gráficos**:
  
* *Mapa de Valencia* dividido por secciones censales por cada causa de mortalidad a estudio (total de 22 mapas). Representación gráfica de los riesgos relativos obtenidos como resultado de su cálculo mediante los siguientes modelos espaciales basados en la distribución de Leroux: LCAR1 + variable privación (como efecto aleatorio y con Random Walk de orden 1 (RW1)), LCAR1 espacial, LCAR2 RW1 y LCAR2 RW2.

* *Gráficos de dispersión* obtenidos a partir de análisis con modelos de suavización LOESS, Rango privación vs log(Riesgos relativos), para cada una de las causas de mortalidad a estudio (total de 22 figuras). Como finalidad, tratamos de estudiar de manera visual cómo cada modelo relaciona la variable privación con el riesgo relativo asociado a cada sección censal.

  por otro lado, una **descripción de resultados numérica**:
  
* Tablas recopilatorias del valor medio de $\lambda_1$ y $\lambda_2$, así como sus correspondientes intervalos de credibilidad del $95\%$, valores del estadístico DIC y el cociente de la varianza del Riesgo relativo obtenida a partir de los modelos de suavizado LOESS entre la varianza de la RME suavizada obtenida con los modelos bayesianos. Código estadístico de Spearman para EPOC y Enfermedad Hepática y Cirrosis.

\newpage

```{r, echo=FALSE}
# Librerías y datos ####

# Obtén el directorio de trabajo actual
directorio_actual <- getwd()

# Cargamos librerías 
source(file.path(directorio_actual, "r", "configuracion.R"))

# Lectura y preparación de los datos 

## Carga los datos desde el archivo
load(file.path(directorio_actual, "datos", "brutos", "Datos.Rdata"))

Obs <- as.data.frame(Obs)
Exp <- as.data.frame(Exp)


## Lectura de los datos de privación. 
datos_medea <- read_excel(file.path(directorio_actual, "datos", "brutos", "datos_medea3_privacion_2001_valencia.xlsx"))
rank <- datos_medea[, 4]
priv <- datos_medea[, 3]
```


# *Descripción gráfica de los resultados*

```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
# Creamos un array vacío para que conforme se vayan cargando los modelos bayesianos, se vayan guardando los resultados de los riesgos relativos en el array. Tendrá 3 dimensiones, 531 filas x 4 columnas (4 modelos) x 22 arrays indv por cada causa de mortalidad que tenemos a estudio.
array_rme_suavizada <- array(NA, dim = c(531, 4, 22))
```

```{r, echo=FALSE}
# Asignar valores a algunas posiciones
array_rme_suavizada[, 1, 1] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 1] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 1] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 1] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE}
# Creamos el objeto Paleta, el cual usaremos en todos los códigos a posteriori para pintar los mapas.
Paleta<-brewer.pal(7,"BrBG")[7:1]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="Sida: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1)

intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```



```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank,
                             lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))


# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```


```{r, echo=FALSE}
# Creamos un array vacío para que conforme se vayan ejecutando los loess, se vayan guardando los resultados de los riesgos relativos predichos en el array. Tendrá 3 dimensiones, 531 filas x 4 columnas (4 modelos) x 22 arrays indv por cada causa de mortalidad que tenmos a estudio.
array_rmes <- array(NA, dim = c(531, 4, 22))
```

```{r, echo=FALSE}
# Asignar valores a algunas posiciones
array_rmes[, 1, 1] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 1] <- exp(lo0.5.lcar)
array_rmes[, 3, 1] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 1] <- exp(lo0.5.lcar2.rw2)
```


```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Sida: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```



```{r, echo=FALSE}
## Cargamos modelos cáncer de estómago####
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 2] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 2] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 2] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 2] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="Cáncer de estómago: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], breaks = intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```



```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 2] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 2] <- exp(lo0.5.lcar)
array_rmes[, 3, 2] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 2] <- exp(lo0.5.lcar2.rw2)
```


```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer estómago: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos cáncer de colon####
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 3] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 3] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 3] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 3] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancercolon: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1)  
intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf) 

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```

```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 3] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 3] <- exp(lo0.5.lcar)
array_rmes[, 3, 3] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 3] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer colon: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))
  
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE}
## Cargamos modelos cáncer de recto ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 4] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 4] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 4] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 4] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancerrecto: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 4] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 4] <- exp(lo0.5.lcar)
array_rmes[, 3, 4] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 4] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer de recto: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))  
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```



```{r, echo=FALSE}
## Cargamos modelos cáncer colorectal####
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 5] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 5] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 5] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 5] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancercolorectal: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1)  
intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```

```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 5] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 5] <- exp(lo0.5.lcar)
array_rmes[, 3, 5] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 5] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer colorectal: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos cáncer laringe####
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 6] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 6] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 6] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 6] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="Cáncer de laringe: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 6] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 6] <- exp(lo0.5.lcar)
array_rmes[, 3, 6] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 6] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer de laringe: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 7] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 7] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 7] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 7] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancerpulmon: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 7] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 7] <- exp(lo0.5.lcar)
array_rmes[, 3, 7] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 7] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer de pulmón: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5)) 
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 8] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 8] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 8] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 8] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancermama: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 8] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 8] <- exp(lo0.5.lcar)
array_rmes[, 3, 8] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 8] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer de mama: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5)) 

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 9] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 9] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 9] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 9] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancerprostata: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 9] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 9] <- exp(lo0.5.lcar)
array_rmes[, 3, 9] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 9] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer de próstata: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))  
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 10] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 10] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 10] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 10] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancervejiga: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 10] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 10] <- exp(lo0.5.lcar)
array_rmes[, 3, 10] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 10] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer de vejiga: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 11] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 11] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 11] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 11] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cancerhemato: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 11] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 11] <- exp(lo0.5.lcar)
array_rmes[, 3, 11] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 11] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cáncer de hemato: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 12] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 12] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 12] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 12] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="diabetes: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 12] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 12] <- exp(lo0.5.lcar)
array_rmes[, 3, 12] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 12] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Diabetes: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 13] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 13] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 13] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 13] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="mentalesorgánicos: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 13] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 13] <- exp(lo0.5.lcar)
array_rmes[, 3, 13] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 13] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Ttos mentales orgánicos: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 14] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 14] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 14] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 14] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="alzheimer: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 14] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 14] <- exp(lo0.5.lcar)
array_rmes[, 3, 14] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 14] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Alzheimer: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 15] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 15] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 15] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 15] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="demencia: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```

```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```


```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 15] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 15] <- exp(lo0.5.lcar)
array_rmes[, 3, 15] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 15] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Demencia: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5)) 
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 16] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 16] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 16] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 16] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="isquemica: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```


```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 16] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 16] <- exp(lo0.5.lcar)
array_rmes[, 3, 16] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 16] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Isquémica del corazón: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 17] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 17] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 17] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 17] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="ictus: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 17] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 17] <- exp(lo0.5.lcar)
array_rmes[, 3, 17] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 17] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Ictus: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5)) 
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 18] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 18] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 18] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 18] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="EPOC: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 18] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 18] <- exp(lo0.5.lcar)
array_rmes[, 3, 18] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 18] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="EPOC: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5)) 
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE, eval=FALSE, message=FALSE}
# Obtenemos el nivel de correlación entre el riesgo estimado y la variable rango.
cor.test(loess$lcar.priv, loess$rank, method = "spearman")
cor.test(loess$lcar1.r, loess$rank, method = "spearman")
cor.test(loess$rw1.r, loess$rank, method = "spearman")
cor.test(loess$rw2.r, loess$rank, method = "spearman")
```



```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 19] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 19] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 19] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 19] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="cirrosis: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 19] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 19] <- exp(lo0.5.lcar)
array_rmes[, 3, 19] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 19] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Cirrosis: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5)) 
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE, eval=FALSE, message=FALSE}
# Obtenemos el nivel de correlación entre el riesgo estimado y la variable rango.
cor.test(loess$lcar.priv, loess$rank, method = "spearman")
cor.test(loess$lcar1.r, loess$rank, method = "spearman")
cor.test(loess$rw1.r, loess$rank, method = "spearman")
cor.test(loess$rw2.r, loess$rank, method = "spearman")
```




```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 20] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 20] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 20] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 20] <- resul.lcar2.rw2[["mean"]][["R"]]
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="suicidios: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 20] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 20] <- exp(lo0.5.lcar)
array_rmes[, 3, 20] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 20] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Suicidios: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 21] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 21] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 21] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 21] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="accidente trafico: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))
legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 21] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 21] <- exp(lo0.5.lcar)
array_rmes[, 3, 21] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 21] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Accidentes de tráfico: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```

```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE}
#Vamos guardando los valores RME suavizados obtenidos con los modelos bayesianos.
array_rme_suavizada[, 1, 22] <- resul.lcar1.priv[["mean"]][["R"]]
array_rme_suavizada[, 2, 22] <- resul.lcar1[["mean"]][["R"]]
array_rme_suavizada[, 3, 22] <- resul.lcar2.rw1[["mean"]][["R"]]
array_rme_suavizada[, 4, 22] <- resul.lcar2.rw2[["mean"]][["R"]]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=15, fig.width=10, fig.align='center', fig.cap="todas las causas: LCAR1 vs LCAR2 RW1 vs LCAR2 RW2 vs LCAR1 + Privación"}
par(mfrow = c(2, 2), mar = c(1, 1, 1, 1) + 0.1);  intervalo_escala <- c(0, 0.70, 0.85, 0.95, 1.05, 1.15, 1.30, Inf)

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1[["mean"]][["R"]], intervalo_escala))], main="LCAR1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw1[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW1", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar2.rw2[["mean"]][["R"]], intervalo_escala))], main="LCAR2 RW2", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

plot(carto, col=Paleta[as.numeric(cut(resul.lcar1.priv[["mean"]][["R"]], intervalo_escala))], main="LCAR1 + Privación", cex.main=1.5, ylim=c(39.46, 39.465),
     xlim=c(-0.4288, -0.29535))

legend(x = "bottomright",c("<0.70","[0.70-0.85)","[0.85-0.95)","[0.95-1.05)","[1.05-1.15)","[1.15-1.30)", ">=1.30"),fill=Paleta, cex = 1)
```


```{r, echo=FALSE}
# Creamos un banco de datos para luego implementarlo en el loess. 
#Aplicamos función logarítimica a la variable de riesgo realtivo, resultado de cada modelo.
loess <- as.data.frame(cbind(rank, lcar.priv=resul.lcar1.priv[["mean"]][["R"]],
                             lcar1.r=resul.lcar1[["mean"]][["R"]],
                             rw1.r=resul.lcar2.rw1[["mean"]][["R"]],
                            rw2.r=resul.lcar2.rw2[["mean"]][["R"]]))

# Aplicamos loess, predecimos.
lo0.5.lcar.priv<-predict(loess(log(lcar.priv) ~ rank , data=loess, span = 0.5))
lo0.5.lcar<-predict(loess(log(lcar1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw1<-predict(loess(log(rw1.r) ~ rank , data=loess, span = 0.5))
lo0.5.lcar2.rw2<-predict(loess(log(rw2.r) ~ rank , data=loess, span = 0.5))

# Guardamos los valores predichos para cada punto en un banco de datos, para así posteriormente poder implementarlo en ggplot más fácilmente.
plo0.5.lcar.priv<-data.frame(x=loess$rank, y=lo0.5.lcar.priv, span=0.5)
plo0.5.lcar<-data.frame(x=loess$rank, y=lo0.5.lcar, span=0.5)
plo0.5.lcar1.rw1<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw1, span=0.5)
plo0.5.lcar1.rw2<-data.frame(x=loess$rank, y=lo0.5.lcar2.rw2, span=0.5)
```

```{r, echo=FALSE}
# Guardamos los valores predichos de riesgo en el array creado. 
array_rmes[, 1, 22] <- exp(lo0.5.lcar.priv); array_rmes[, 2, 22] <- exp(lo0.5.lcar)
array_rmes[, 3, 22] <- exp(lo0.5.lcar2.rw1); array_rmes[, 4, 22] <- exp(lo0.5.lcar2.rw2)
```

```{r, echo=FALSE}
# Obtener los límites de los ejes de datos. De momento, implementaremos los mismo ejes para todas las causas de mortalidad basándonos en sida, luego veremos.
limites_x <- range(rank)
limites_y <- range(log(loess$lcar.priv), log(loess$lcar1.r), log(loess$rw1.r), log(loess$rw2.r))
```


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap="Todas las causas: LOESS. Asociación con variable privación"}
# Creamos los gráficos con ggplot.
plot1 <- ggplot(loess, aes(x=rank, y=log(lcar1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar, mapping=aes(x=x,y=y), color="green", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot2 <- ggplot(loess, aes(x=rank, y=log(rw1.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw1, mapping=aes(x=x,y=y), color="red", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW1",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))


plot3 <- ggplot(loess, aes(x=rank, y=log(rw2.r))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar1.rw2, mapping=aes(x=x,y=y), color="darkblue", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR2 RW2",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))

plot <- ggplot(loess, aes(x=rank, y=log(lcar.priv))) + 
  geom_point(alpha=0.2) + 
  geom_line(plo0.5.lcar.priv, mapping=aes(x=x,y=y), color="purple", size=1) + 
  theme(legend.position = "none") +  
  coord_cartesian(xlim = limites_x, ylim = limites_y) +
  labs(title = "LCAR1 + Privación",
       x = "Rango privación",
       y = "log(Riesgo relativo)") +
  theme(plot.title.position = "plot",
        plot.title = element_text(hjust = 0.5, vjust = 0.5))
# con este código podemos unirlos en las misma figura.
grid.arrange(plot1, plot2, plot3, plot, ncol = 2, nrow = 2)
```







\newpage

# *Descripción numérica de los resultados*

```{r, echo=FALSE}
# Datos RME suavizada ####
#situados en el array de 3 dimensiones c(531, 4, 22) = array_rme_suavizada

# Calcular la media por columna y por slice, dimensiones:[1]  4 22
media_por_columna_suavizada <- apply(array_rme_suavizada, c(2, 3), mean)
# Calcular la varianza por columna y por slice : [1]  4 22
var_por_columna_suavizada <- apply(array_rme_suavizada, c(2, 3), var)

# Agregar una dimensión al resultado: dimesiones  (1  4 22)
media_por_columna_suavizada <- array(media_por_columna_suavizada, dim = c(1, dim(media_por_columna)))
var_por_columna_suavizada <- array(var_por_columna_suavizada, dim = c(1, dim(var_por_columna_suavizada)))

# Fusionar los dos arrays a lo largo de la primera dimensión
resultado_rme_suavizada <- abind(media_por_columna_suavizada, var_por_columna_suavizada, along = 1)
```

```{r, echo=FALSE, eval=FALSE}
# Ver las dimensiones del resultado
# Como resultado, hemos obtenido un array de 3 dimensiones, 2 filas (media y varianza, respectivamente) x 4 columnas (modelos analizados) x 22 slices (causas de mortalidad)
(dim(resultado_rme_suavizada))
```

```{r, echo=FALSE}
# DAtos Resultados: ####
#situados en el array de 3 dimensiones c(531, 4, 22) = array_rmes

# Calcular la media por columna y por slice
media_por_columna <- apply(array_rmes, c(2, 3), mean)
# Calcular la varianza por columna y por slice 
var_por_columna <- apply(array_rmes, c(2, 3), var)

# Agregar una dimensión al resultado
media_por_columna <- array(media_por_columna, dim = c(1, dim(media_por_columna)))
var_por_columna <- array(var_por_columna, dim = c(1, dim(var_por_columna)))

# Fusionar los dos arrays a lo largo de la primera dimensión
resultado <- abind(media_por_columna, var_por_columna, along = 1)
```

```{r, echo=FALSE, eval=FALSE}
# Ver las dimensiones del resultado
# Como resultado, hemos obtenido un array de 3 dimensiones, 2 filas (media y varianza, respectivamente) x 4 columnas (modelos analizados) x 22 slices (causas de mortalidad)
(dim(resultado))
```


```{r, echo=FALSE}
#Dividimos las varianzas obtenidas mediante el predict(loess) entre las varianzas de los datos brutos.
# la fila 2 del array corresponde con las varianzas de los loess.
# Inicializar un array para almacenar los cocientes
cociente_varianzas <- array(NA, dim = c(1, 4, 22))

# Calcular los cocientes y almacenarlos en el array
for (i in 1:22) {
  cociente_varianzas[, , i] <- resultado[2, , i] / resultado_rme_suavizada[2, , i]
}
```


```{r, echo=FALSE, eval=FALSE}
# Comprobación de que s está haciendo bien la división
resultado[2,,18] /resultado_rme_suavizada[2,,18]
cociente_varianzas[,,18]

resultado[2,,19] /resultado_rme_suavizada[2,,19]
cociente_varianzas[,,19]
```




```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "sida","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Sida: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)

cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_estomago","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer estómago: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```





```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colon","resul.lcar2.rw2.Rdata"))
```



```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer colon: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```



```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_recto","resul.lcar2.rw2.Rdata"))
```



```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer recto: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_colorectal","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer colorectal: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_laringe","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer laringe: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_pulmon","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer pulmón: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_mama","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer mama: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_prostata","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer próstata: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_vejiga","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer vejiga: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cancer_hemato","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cáncer vejiga: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "diabetes","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Diabetes: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "mentales_orgánicos","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Ttos mentales orgánicos: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "alzheimer","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Alzheimer: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "demencia","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Demencia: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "isquemica","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[534, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Isquémica del corazón: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "ictus","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Ictus: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "epoc","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Epoc: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "cirrosis","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Cirrosis: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "suicidios","resul.lcar2.rw2.Rdata"))
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Suicidios: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "accidente_trafico","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Accidente de tráfico: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```


```{r, echo=FALSE}
## Cargamos modelos ####
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar1.priv.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar2.rw1.Rdata"))
load(file.path(directorio_actual, "datos", "resultados", "todas_causas","resul.lcar2.rw2.Rdata"))
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
# resul.lcar1.priv$summary[3, c(3,7)] contiene los límites del intervalo ####
intervalo_lcar1.priv <- as.vector(round(resul.lcar1.priv$summary[534, c(3, 7)], 3))
# Representar el intervalo como a-b
ic_lcar1.priv <- paste0(intervalo_lcar1.priv[1], "-", intervalo_lcar1.priv[2])

# copiamos código para los demás modelos:
## lcar1
intervalo_lcar1 <- as.vector(round(resul.lcar1$summary[3, c(3, 7)], 3))
ic_lcar1 <- paste0(intervalo_lcar1[1], "-", intervalo_lcar1[2])

## lcar2.rw1
### lambda 1
intervalo_lcar2.rw1_lambda1 <- as.vector((round(resul.lcar2.rw1$summary[3, c(3,7)],3)))
ic_lcar2.rw1_lambda1 <- paste0(intervalo_lcar2.rw1_lambda1[1], "-", intervalo_lcar2.rw1_lambda1[2])
### lambda 2
intervalo_lcar2.rw1_lambda2 <- as.vector((round(resul.lcar2.rw1$summary[4, c(3,7)],3)))
ic_lcar2.rw1_lambda2 <- paste0(intervalo_lcar2.rw1_lambda2[1], "-", intervalo_lcar2.rw1_lambda2[2])

## lcar2.rw2
### lambda 1
intervalo_lcar2.rw2_lambda1 <- as.vector((round(resul.lcar2.rw2$summary[3, c(3,7)],3)))
ic_lcar2.rw2_lambda1 <- paste0(intervalo_lcar2.rw2_lambda1[1], "-", intervalo_lcar2.rw2_lambda1[2])
### lambda 2
intervalo_lcar2.rw2_lambda2 <- as.vector((round(resul.lcar2.rw2$summary[4, c(3,7)],3)))
ic_lcar2.rw2_lambda2 <- paste0(intervalo_lcar2.rw2_lambda2[1], "-", intervalo_lcar2.rw2_lambda2[2])

# Creamos un data.frame #### 
datos.tabla <- data.frame(
  Parámetros = c("mean.lambda.1", "IC.lambda.1", "mean.lambda.2", "IC.lambda.2",
                 "DIC", "Coc.var"),
  
  LCAR1 = c(round(resul.lcar1[["mean"]][["lambda.1"]], 3),
                 ic_lcar1,
                 "-", "-",
                 round(resul.lcar1[["DIC"]], 3),
                 round(cociente_varianzas[1, 2, 1], 3)
            ),
  
  LCAR2.RW1 = c(round(resul.lcar2.rw1[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw1_lambda1,
                round(resul.lcar2.rw1[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw1_lambda2,
                round(resul.lcar2.rw1[["DIC"]], 3),
                round(cociente_varianzas[1, 3, 1], 3)
                ),
  
  LCAR2.RW2 = c(round(resul.lcar2.rw2[["mean"]][["lambda.1"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["mean"]][["lambda.2"]], 3),
                ic_lcar2.rw2_lambda1,
                round(resul.lcar2.rw2[["DIC"]], 3),
                round(cociente_varianzas[1, 4, 1], 3)
                ),
  
  LCAR1.PRIV = c(round(resul.lcar1.priv[["mean"]][["lambda.1"]], 3),
                 ic_lcar1.priv,
                 "-", "-",
                 round(resul.lcar1.priv[["DIC"]], 3),
                 round(cociente_varianzas[1, 1, 1], 3)
                 )
  )


# Convierte el dataframe a una tabla LaTeX ####
tabla_latex <- kable(datos.tabla, caption = "Todas las causas: Lambdas, DIC, 
                      Cociente varianzas", format = "latex", booktabs = TRUE)
cat(tabla_latex)
```

















